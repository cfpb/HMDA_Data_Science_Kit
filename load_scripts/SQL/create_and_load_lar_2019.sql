DROP TABLE IF EXISTS hmda_public.lar_2019;
CREATE TABLE hmda_public.lar_2019 (
    activity_year VARCHAR,
    lei VARCHAR,
    msa_md VARCHAR(5),
    state_code VARCHAR(2),
    county_code VARCHAR(5),
    census_tract VARCHAR(11),
    conforming_loan_flag VARCHAR(2),
    derived_loan_product_type VARCHAR,
    derived_dwelling_category VARCHAR,
    derived_ethnicity VARCHAR,
    derived_race VARCHAR,
    derived_sex VARCHAR,
    action_type VARCHAR,
    purchaser_type VARCHAR(2),
    preapprovals VARCHAR(1),
    loan_type VARCHAR(1),
    loan_purpose VARCHAR(2),
    lien_status VARCHAR(1),
    reverse_mortgage VARCHAR(4),
    open_end_credit VARCHAR(4),
    business_purpose VARCHAR(4),
    loan_amount VARCHAR,
    cltv VARCHAR,
    interest_rate VARCHAR,
    rate_spread VARCHAR,
    hoepa_status VARCHAR,
    total_loan_costs VARCHAR,
    total_points_and_fees VARCHAR,
    origination_charges VARCHAR,
    discount_points VARCHAR,
    lender_credits VARCHAR,
    loan_term VARCHAR,
    prepayment_penalty_term VARCHAR,
    intro_rate_period VARCHAR,
    negative_amortization VARCHAR(4),
    interest_only_payments VARCHAR(4),
    balloon_paymnet VARCHAR(4),
    other_nonamortizing_features VARCHAR(4),
    property_value VARCHAR,
    construction_method VARCHAR(1),
    occupancy VARCHAR(1),
    manufactured_property_type VARCHAR(4),
    manufactured_land_interest VARCHAR(4),
    total_units VARCHAR,
    multifamily_affordable_units VARCHAR,
    income VARCHAR,
    dti VARCHAR,
    applicant_credit_score_type VARCHAR,
    co_applicant_credit_score_type VARCHAR,
    applicant_ethnicity_1 VARCHAR(2),
    applicant_ethnicity_2 VARCHAR(2),
    applicant_ethnicity_3 VARCHAR(2),
    applicant_ethnicity_4 VARCHAR(2),
    applicant_ethnicity_5 VARCHAR(2),
    co_applicant_ethnicity_1 VARCHAR(2),
    co_applicant_ethnicity_2 VARCHAR(2),
    co_applicant_ethnicity_3 VARCHAR(2),
    co_applicant_ethnicity_4 VARCHAR(2),
    co_applicant_ethnicity_5 VARCHAR(2),
    applicant_ethnicity_observed VARCHAR(1),
    co_applicant_ethnicity_observed VARCHAR(1),
    applicant_race_1 VARCHAR(2),
    applicant_race_2 VARCHAR(2),
    applicant_race_3 VARCHAR(2),
    applicant_race_4 VARCHAR(2),
    applicant_race_5 VARCHAR(2),
    co_applicant_race_1 VARCHAR(2),
    co_applicant_race_2 VARCHAR(2),
    co_applicant_race_3 VARCHAR(2),
    co_applicant_race_4 VARCHAR(2),
    co_applicant_race_5 VARCHAR(2),
    applicant_race_observed VARCHAR(1),
    co_applicant_race_observed VARCHAR(1),
    applicant_sex VARCHAR(1),
    co_applicant_sex VARCHAR(1),
    applicant_sex_observed VARCHAR(1),
    co_applicant_sex_observed VARCHAR(1),
    applicant_age VARCHAR,
    co_applicant_age VARCHAR,
    applicant_age_above_62 VARCHAR(3),
    co_applicant_age_above_62 VARCHAR(3),
    submission_of_application VARCHAR(4),
    initially_payable VARCHAR(4),
    aus_1 VARCHAR(4),
    aus_2 VARCHAR(1),
    aus_3 VARCHAR(1),
    aus_4 VARCHAR(1),
    aus_5 VARCHAR(1),
    denial_1 VARCHAR(4),
    denial_2 VARCHAR(1),
    denial_3 VARCHAR(1),
    denial_4 VARCHAR(1),
    tract_population VARCHAR,
    trac_tminority_population_percent VARCHAR,
    ffiec_msamd_median_income VARCHAR,
    tract_to_msa_income_percent VARCHAR,
    tract_owner_occupied_units VARCHAR,
    tract_one_to_four_units VARCHAR,
    tract_median_housing_age VARCHAR
    );


COPY hmda_public.lar_2019

FROM '{data_path}/data/lar/lar_2019.txt'

DELIMITER '|' ENCODING 'latin1' CSV HEADER;
